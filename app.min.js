function n(n,o){const{latitude:e,longitude:t}=o.coords,r=L.latLng(e,t);n.setLatLng(r),map.panBy(r)}const o=L.icon({iconUrl:"assets/images/green-marker.png",iconSize:[41,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});fetch("filtered-data.json").then((n=>n.json())).then((e=>{const t=function(){const n=L.map("map").setView([6.28,1.22],12);return L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'}).addTo(n),n}();let r;navigator.geolocation?navigator.geolocation.watchPosition((function(o){r?n(r,o):r=function(n,o){const{latitude:e,longitude:t}=o.coords,r=L.latLng(e,t),a=L.marker(r,{icon:L.icon({iconUrl:"assets/images/red-marker-icon.png"})}).addTo(n);return a.bindPopup("It's me").openPopup(),a}(t,o)}),(n=>{console.error("Error getting user location:",n)})):console.error("Geolocation is not supported by your browser"),async function(n){const o=await fetch(n),e=await o.json();return Array.isArray(e)?e:[]}("pharmacy_names.json").then((n=>{e.forEach((e=>{n.find((({name:n})=>function(n,o){const e=n=>n?n.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):n;return e(n)===e(o)}(n,e.name)))&&(e.onDuty=!0),function(n,e){const t=L.marker([e.lat,e.lon]).addTo(n);e.onDuty&&t.setIcon(o);const r=L.popup().setContent(`\n    <h4>${e.name}</h4>\n    <p>${e.phone}</p>\n    <p>${e.onDuty?"De garde":"Pas de garde"}</p>\n  `);t.bindPopup(r)}(t,e)}))}))})).catch((n=>{console.error("Erreur en chargeant les donn√©es de pharmacies",n)}));